<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Erudyte Commons</title>
  <!-- SEO Meta Tags -->
  <meta name="description" content="Erudyte Commons">
  <meta name="keywords" content="teacher hub, educator network, STEM education, brand resources, workforce impact, inclusive education, language accessibility, neurodiverse learning, learning resources, online courses, conference landing, e-learning, teaching tools, teacher training, education platform">
  <meta name="author" content="Erudtion Inc">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Favicon and Touch Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="assets/favicon/site.webmanifest">
  <link rel="mask-icon" href="assets/favicon/safari-pinned-tab.svg" color="#6366f1">
  <link rel="shortcut icon" href="assets/favicon/favicon.ico">
  <meta name="msapplication-TileColor" content="#080032">
  <meta name="msapplication-config" content="assets/favicon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  
  <!-- Vendor Styles -->
  <link rel="stylesheet" media="screen" href="assets/vendor/boxicons/css/boxicons.min.css"/>
  <link rel="stylesheet" media="screen" href="assets/vendor/swiper/swiper-bundle-library.css"/>
  <link rel="stylesheet" media="screen" href="assets/vendor/lightgallery/css/lightgallery-bundle.min.css"/>
  
  <!-- Bootstrap -->
  <link rel="stylesheet" media="screen" href="/assets/css/library-theme.css">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* Loading Styles */
    .page-loading {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      -webkit-transition: all .4s .2s ease-in-out;
      transition: all .4s .2s ease-in-out;
      background-color: #fff;
      opacity: 0;
      visibility: hidden;
      z-index: 9999;
    }

    .page-loading.active {
      opacity: 1;
      visibility: visible;
    }

    .page-loading-inner {
      position: absolute;
      top: 50%;
      left: 0;
      width: 100%;
      text-align: center;
      -webkit-transform: translateY(-50%);
      transform: translateY(-50%);
      -webkit-transition: opacity .2s ease-in-out;
      transition: opacity .2s ease-in-out;
      opacity: 0;
    }

    .page-loading.active > .page-loading-inner {
      opacity: 1;
    }

    .page-loading-inner > span {
      display: block;
      font-size: 1rem;
      font-weight: normal;
      color: #9397ad;
    }

    .page-spinner {
      display: inline-block;
      width: 2.75rem;
      height: 2.75rem;
      margin-bottom: .75rem;
      vertical-align: text-bottom;
      border: .15em solid #b4b7c9;
      border-right-color: transparent;
      border-radius: 50%;
      -webkit-animation: spinner .75s linear infinite;
      animation: spinner .75s linear infinite;
    }

    @keyframes spinner {
      100% {
        transform: rotate(360deg);
      }
    }

    /* Layout Styles */
    main {
      height: 100vh !important;
      overflow-y: hidden;
    }

    .page-content-wraper {
      margin-top: 63px;
      height: calc(100vh - 63px);
      width: 100%;
      display: grid;
      overflow-x: hidden;
      overflow-y: auto;
      padding: 1rem;
      grid-template-areas:
        "filter slide"
        "filter content";
      grid-template-columns: 0.4fr 1.6fr;
      gap: 1rem;
      background: #faf4ff;
    }

    /* Filter Styles */
    .filters {
      grid-area: filter;
      padding: 1rem;
      position: relative;
    }

    .filter-wrapper {
      padding: 1rem;
      background: white;
      border-radius: 0.5rem;
      border: 1px solid rgb(208, 208, 208);
      position: sticky;
      top: 15%;
    }

    .filter-tags {
      padding-top: 1rem;
      margin-top: 0.5rem;
      border-top: 1px solid #e5e7eb;
    }

    /* Slideshow Styles */
    .slide-show {
      grid-area: slide;
      padding: 1rem;
    }

    /* Content Styles */
    .main-content {
      grid-area: content;
      padding: 1rem;
      min-height: 30rem;
    }

    .content-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(18rem, 1fr));
      gap: 1.5rem;
      padding: 1rem;
    }

    .content-item {
      height: 25rem;
      background-color: white;
      border-radius: 0.5rem;
      overflow: hidden;
      display: grid;
      grid-template-rows: 1fr 1fr;
      position: relative;
      transition: 0.3s ease-in-out;
    }

    .content-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .content-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .content-item-top {
      width: 100%;
      height: 100%;
      overflow: hidden;
      position: relative;
    }

    .content-item-bottom {
      padding: 1rem;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .item-type {
      position: absolute;
      top: 15px;
      left: 10px;
      border-radius: 0.3rem;
      padding: 0.25rem 1rem;
      color: white;
      font-size: 0.875rem;
      z-index: 1;
    }

    .item-type.green { background-color: #22c55d; }
    .item-type.orange { background-color: #e89633; }
    .item-type.blue { background-color: #6fc1f7; }
    .item-type.black { background-color: #262728; }

    /* PDF Styles */
    .pdf-visual {
      height: 100%;
      width: 100%;
      background-color: #262728;
      position: relative;
      display: grid;
      place-items: center;
    }

    .pdf-i-front {
      background: #f2503b;
      color: white;
      padding: 2rem;
      z-index: 2;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    .pdf-i-back {
      position: absolute;
      background: rgba(242, 80, 59, 0.8);
      width: 100%;
      height: 100%;
      transform: rotate(-4deg);
      z-index: 1;
    }

    /* Tab Styles */
    .tabs-wrapper {
      margin-bottom: 2rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .nav-tabs {
      border: none;
      margin-bottom: -1px;
    }

    .nav-link {
      border: none;
      border-bottom: 2px solid transparent;
      padding: 0.75rem 1.5rem;
      color: #6b7280;
      transition: 0.3s ease;
    }

    .nav-link.active {
      color: #6366f1;
      border-bottom-color: #6366f1;
    }

    /* Admin Controls */
    .card-controls {
      position: absolute;
      top: 15px;
      right: 10px;
      width: 2rem;
      height: 2rem;
      border-radius: 100%;
      background: rgba(131, 131, 154, 0.55);
      display: grid;
      place-items: center;
      color: white;
      cursor: pointer;
      z-index: 2;
    }

    .card-control-options {
      position: absolute;
      top: 3.5rem;
      right: 10px;
      background: white;
      border-radius: 0.4rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: 0.3s ease;
      z-index: 3;
    }

    .card-control-options.visible {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .card-control-options button {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      width: 100%;
      border: none;
      background: none;
      color: #374151;
      cursor: pointer;
    }

    .card-control-options button:hover {
      background: #f3f4f6;
    }

    @media (max-width: 800px) {
      .page-content-wraper {
        grid-template-areas:
          "slide"
          "filter"
          "content";
        grid-template-columns: 1fr;
      }

      .filter-wrapper {
        margin-bottom: 1rem;
      }

      .content-list {
        justify-items: center;
      }
    }
  </style>
</head>
<body>
  <!-- Page loading spinner -->
  <div class="page-loading active">
    <div class="page-loading-inner">
      <div class="page-spinner"></div>
      <span>Loading...</span>
    </div>
  </div>

  <main class="library-page-container">
    <%- include('navbar') %>
    
    <div class="page-content-wraper">
      <!-- Left Sidebar -->
      <div class="filters">
        <div class="filter-wrapper">
          <div class="filter-categories">
            <h3 class="h5">Filter</h3>
            <ul class="nav flex-column fs-sm">
              <li class="nav-item mb-1">
                <a href="#" class="nav-link py-1 px-0 active">All topics <span class="fw-normal opacity-60 ms-1">(48)</span></a>
              </li>
              <li class="nav-item mb-1">
                <a href="#" class="nav-link py-1 px-0">Digital <span class="fw-normal opacity-60 ms-1">(12)</span></a>
              </li>
              <li class="nav-item mb-1">
                <a href="#" class="nav-link py-1 px-0">Marketing <span class="fw-normal opacity-60 ms-1">(5)</span></a>
              </li>
              <li class="nav-item mb-1">
                <a href="#" class="nav-link py-1 px-0">Startups <span class="fw-normal opacity-60 ms-1">(10)</span></a>
              </li>
              <li class="nav-item mb-1">
                <a href="#" class="nav-link py-1 px-0">Technology <span class="fw-normal opacity-60 ms-1">(9)</span></a>
              </li>
              <li class="nav-item mb-1">
                <a href="#" class="nav-link py-1 px-0">Business <span class="fw-normal opacity-60 ms-1">(4)</span></a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link py-1 px-0">Processes & Tools <span class="fw-normal opacity-60 ms-1">(3)</span></a>
              </li>
            </ul>
          </div>

          <div class="filter-tags">
            <h3 class="h5">Tags</h3>
            <div class="d-flex flex-wrap">
              <a href="#" class="btn btn-outline-secondary btn-sm px-3 my-1 me-2">#lifestyle</a>
              <a href="#" class="btn btn-outline-secondary btn-sm px-3 my-1 me-2">#ux</a>
              <a href="#" class="btn btn-outline-secondary btn-sm px-3 my-1 me-2">#tech</a>
              <a href="#" class="btn btn-outline-secondary btn-sm px-3 my-1 me-2">#user</a>
              <a href="#" class="btn btn-outline-secondary btn-sm px-3 my-1 me-2">#software</a>
              <a href="#" class="btn btn-outline-secondary btn-sm px-3 my-1 me-2">#it</a>
              <a href="#" class="btn btn-outline-secondary btn-sm px-3 my-1 me-2">#network</a>
              <a href="#" class="btn btn-outline-secondary btn-sm px-3 my-1 me-2">#engineering</a>
            </div>
          </div>
        </div>
      </div>

<!-- Top Section -->
<div class="slide-show">
  <!-- Search Form -->
  <form class="mb-4" style="width:400px;position:relative;">
    <input type="text" placeholder="Search the library..." class="form-control rounded pe-5">
    <i class='bx bx-search position-absolute top-50 end-0 translate-middle-y me-3 fs-lg zindex-5'></i>
  </form>

  <!-- Featured Article -->
  <div class="swiper-container">
    <div class="swiper-wrapper">
      <div class="swiper-slide bg-light">
        <div class="ratio ratio-21x9 bg-faded-info">
          <div class="position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center">
            <article class="card border-0 shadow-sm overflow-hidden">
              <div class="row2 g-0">
                <div class="col-sm-4 position-relative bg-position-center bg-repeat-0 bg-size-cover" style="background-image: url(assets/img/blog/09.jpg); min-height: 15rem;">
                  <a href="#" class="position-absolute top-0 start-0 w-100 h-100" aria-label="Read more"></a>
                </div>
                <div class="col-sm-8">
                  <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                      <a href="#" class="badge fs-sm text-nav bg-secondary text-decoration-none">Article</a>
                      <span class="fs-sm text-muted border-start ps-3 ms-3">May 19, 2021</span>
                    </div>
                    <h3 class="h4">
                      <a href="#">Lorem Ipsum: What does it mean?</a>
                    </h3>
                    <p>moenr foenrfoemrf eorfis donen enrfoenrf jjnerfer <br>onerdjfiejn irf nie nrfoiwe mimdf owinem dfo...</p>
                  </div>
                </div>
              </div>
            </article>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Main Content -->
<div class="main-content">
   <!-- Tabs Navigation -->
 <div class="tabs-wrapper">
  <ul class="nav nav-tabs border-0">
    <li class="nav-item">
      <a class="nav-link active text-dark px-3" data-bs-toggle="tab" href="#all">All</a>
      <div class="tab-content">
        <!-- All Tab Content -->
        <div style="height: 50px; width: 100%; background-color: transparent;"></div>
        <div class="tab-pane fade show active" id="all">
          <div class="content-list">
            <% try { %>
              <!-- Keep existing libraryData loop -->
              <% if (libraryData && libraryData.length > 0) { %>
            <% } else { %>
              <div class="no-content text-center">
                <img src="/public/assets/img/portfolio/hero.jpg" alt="No content">
                <h3>Browse Our Library</h3>
                <p>Explore our collection of courses, lessons, and educational resources</p>
              </div>
            <% } %>
          <% } catch (error) { %>
            <div class="error-message">
              <p>An error occurred while loading the content.</p>
            </div>
          <% } %>
        </div>
      </div>
    </li>
    <li class="nav-item">
      <a class="nav-link text-muted px-3" data-bs-toggle="tab" href="#courses">Courses and Lessons</a>
      <!-- Courses Tab Content -->
      <div class="tab-content">
        <div style="height: 50px; width: 100%; background-color: transparent;"></div>
  <div class="tab-pane fade" id="courses">
    <div class="no-content text-center">
      <img src="/public/assets/img/portfolio/hero.jpg" alt="No courses">
      <h3>Discover Our Courses</h3>
      <p>Find comprehensive courses and lessons to enhance your learning</p>
    </div>
  </div>
    </li>
    <li class="nav-item">
      <a class="nav-link text-muted px-3" data-bs-toggle="tab" href="#videos">Videos</a>
          <!-- Videos Tab Content -->
          <div class="tab-content">
            <div style="height: 50px; width: 100%; background-color: transparent;"></div>
             <div class="tab-pane fade" id="videos">
              <div class="no-content text-center">
              <img src="/public/assets/img/portfolio/hero.jpg" alt="No videos">
      <h3>Watch & Learn</h3>
      <p>Access our library of educational videos and tutorials</p>
    </li>
    </div>
  </div>
</div>
  </ul>
</div>
</div>

  <!-- Pagination -->
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      <li class="page-item">
        <a href="#" class="page-link">
          <i class="bx bx-chevron-left ms-n1 me-1"></i>
          Prev
        </a>
      </li>
      <li class="page-item active">
        <span class="page-link">1</span>
      </li>
      <li class="page-item">
        <a href="#" class="page-link">2</a>
      </li>
      <li class="page-item">
        <a href="#" class="page-link">3</a>
      </li>
      <li class="page-item">
        <a href="#" class="page-link">
          Next
          <i class="bx bx-chevron-right me-n1 ms-1"></i>
        </a>
      </li>
    </ul>
  </nav>
</div>

<!-- Admin Scripts -->
<% if (role === 'Admin') { %>
  <script>
    const confirm_delete_box = document.querySelector('.confirm-delete');
    let item_being_deleted = null;

    function handleCardControlClick(element) {
      const options = element.parentElement.querySelector('.card-control-options');
      options.classList.toggle('hidden');
    }

    function hideControlOptions(card) {
      card.classList.add('hidden');
    }

    async function setVisibilityPublic(type, title, element) {
      try {
        const response = await fetch("set-public-status", {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({type, title})
        });
        
        if (response.status === 200) {
          element.parentElement.parentElement.parentElement.querySelector('.post-status-type').innerHTML = 
            '<i title="Public" class="fa-solid fa-eye"></i>';
        } else {
          alert('Error setting post as public!');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Error setting post visibility');
      }
      hideControlOptions(element.parentElement);
    }

    async function setVisibilityPrivate(type, title, element) {
      try {
        const response = await fetch("set-private-status", {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({type, title})
        });
        
        if (response.status === 200) {
          element.parentElement.parentElement.parentElement.querySelector('.post-status-type').innerHTML = 
            '<i title="Private" class="fa-solid fa-eye-slash red-color"></i>';
        } else {
          alert('Error setting post as private!');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Error setting post visibility');
      }
      hideControlOptions(element.parentElement);
    }

    async function deletePost() {
      const type = confirm_delete_box.getAttribute('data-type');
      const title = confirm_delete_box.getAttribute('data-title');
      
      try {
        const response = await fetch("delete-library-post", {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({type, title})
        });
        
        if (response.status === 200) {
          item_being_deleted.remove();
        } else {
          alert('Error Deleting Post Item!');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Error deleting post');
      }
      hideConfirmDelete();
    }

    function showConfirmDelete(type, title, element) {
      confirm_delete_box.setAttribute('data-type', type);
      confirm_delete_box.setAttribute('data-title', title);
      confirm_delete_box.querySelector('.confirm-detele-title').innerText = title;
      confirm_delete_box.style.display = 'grid';
      item_being_deleted = element.parentElement.parentElement.parentElement;
    }

    function hideConfirmDelete() {
      confirm_delete_box.style.display = 'none';
      confirm_delete_box.setAttribute('data-type', '');
      confirm_delete_box.setAttribute('data-title', '');
      confirm_delete_box.querySelector('.confirm-detele-title').innerText = '';
    }

    function editPost(type, title) {
      const form = document.createElement('form');
      form.action = 'edit-library-post';
      form.method = 'post';

      const typeInput = document.createElement('input');
      typeInput.value = type;
      typeInput.name = 'type';

      const titleInput = document.createElement('input');
      titleInput.value = title;
      titleInput.name = 'title';

      form.appendChild(typeInput);
      form.appendChild(titleInput);
      document.body.appendChild(form);
      form.submit();
    }
  </script>
<% } %>

<!-- Loading Script -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const preloader = document.querySelector('.page-loading');
    if (preloader) {
      preloader.classList.remove('active');
      setTimeout(function() {
        preloader.style.display = 'none';
      }, 300);
    }
  });
</script>

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
